\documentclass{article}
\usepackage{CJKutf8}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{amsmath}

\usepackage{geometry}
\newgeometry{vmargin={10mm,10mm}, hmargin={8mm,8mm}}   

\begin{CJK}{UTF8}{bsmi}
    
\title{Numerical Linear Algebra HW1}
\date{}
\author{b05502087 王竑睿}

\begin{document}
    \maketitle
    \section*{}
    \includegraphics[scale=1.1]{img001.jpg}
    \section*{}
    \includegraphics[scale=1.1]{img002.jpg}
    \newpage
    \section*{4}
        \subsection*{(a)}
            \begin{equation*}
                Q_{clgs} = \left[
                \begin{array}{ccc}
                    0.101015254455221 &  0.316173069524858 &  0.541996899879457\\
                    0.404061017820884 &  0.353369901233665 &  0.516187523694721\\
                    0.707106781186548 &  0.390566732942472 & -0.524790649089635\\
                    0.404061017820884 & -0.557952475632102 &  0.387140642771042\\
                    0.404061017820884 & -0.557952475632102 & -0.120443755528768\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                R_{clgs} = \left[    
                \begin{array}{ccc}
                    9.899494936611665 &  9.495433918790781 &  9.697464427701224\\
                    0 &  3.291919606229403 &  3.012943368413355\\
                    0 &                  0 &  1.970115715434855\\
                \end{array}
                \right]
            \end{equation*}
        \subsection*{(b)}
            \begin{equation*}
                Q_{mgs} = \left[
                \begin{array}{ccc}
                    0.101015254455221 &  0.316173069524858 &  0.541996899879458\\
                    0.404061017820884 &  0.353369901233665 &  0.516187523694722\\
                    0.707106781186548 &  0.390566732942472 & -0.524790649089634\\
                    0.404061017820884 & -0.557952475632102 &  0.387140642771041\\
                    0.404061017820884 & -0.557952475632102 & -0.120443755528769\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                R_{mgs} = \left[    
                \begin{array}{ccc}
                    9.899494936611665 &  9.495433918790781 &  9.697464427701224\\
                    0 &  3.291919606229403 &  3.012943368413352\\
                    0 &                  0 &  1.970115715434855\\
                \end{array}
                \right]
            \end{equation*}
        \subsection*{(c)}
            \begin{equation*}
                Q_{house} = \left[
                \begin{array}{ccccc}
                    -0.101015254455221 & -0.316173069524858 &  0.541996899879458\\
                    -0.404061017820884 & -0.353369901233664 &  0.516187523694722\\
                    -0.707106781186547 & -0.390566732942472 & -0.524790649089634\\
                    -0.404061017820884 &  0.557952475632102 &  0.387140642771042\\
                    -0.404061017820884 &  0.557952475632102 & -0.120443755528768\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                R_{house} = \left[    
                \begin{array}{ccc}
                    -9.899494936611665 & -9.495433918790781 & -9.697464427701224\\
                    0 & -3.291919606229404 & -3.012943368413353\\
                    0 &                  0 &  1.970115715434854\\
                \end{array}
                \right]
            \end{equation*}
        \subsection*{(d)}
            \begin{equation*}
                Q_{qr} = \left[
                \begin{array}{ccc}
                    -0.101015254455221 & -0.316173069524858 &  0.541996899879458\\
                    -0.404061017820884 & -0.353369901233665 &  0.516187523694722\\
                    -0.707106781186548 & -0.390566732942472 & -0.524790649089634\\
                    -0.404061017820884 &  0.557952475632102 &  0.387140642771041\\
                    -0.404061017820884 &  0.557952475632102 & -0.120443755528768\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                R_{qr} = \left[    
                \begin{array}{ccc}
                    -9.899494936611665 & -9.495433918790781 & -9.697464427701224\\
                    0 & -3.291919606229403 & -3.012943368413352\\
                    0 &                  0 &  1.970115715434855\\
                \end{array}
                \right]
            \end{equation*}
        \begin{itemize}
            \item house.m以及formQ.m計算出的Q其實是full QR-decomposition的Q(5x5)，上面取前3個行向量(reduce)
            \item Qhouse,Qqr計算出的前兩個行向量方向和Qmgs,Qclgs相反
            \item 由以下結果可以發現，Qhouse以及Qqr非常接近，Qclgs以及Qmgs非常接近
        \end{itemize}
            \begin{equation*}
                Q_{clgs} - Q_{mgs} = (1.0e-15) * \left[
                \begin{array}{ccc}
                    0 &                  0 & -0.444089209850063\\
                    0 &                  0 & -0.555111512312578\\
                    0 &                  0 & -0.555111512312578\\
                    0 &                  0 &  0.777156117237609\\
                    0 &                  0 &  0.791033905045424\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                Q_{clgs} - Q_{house} = \left[
                \begin{array}{ccc}
                    0.202030508910442 &  0.632346139049716 & -0.000000000000000\\
                    0.808122035641769 &  0.706739802467329 & -0.000000000000001\\
                    1.414213562373095 &  0.781133465884943 & -0.000000000000001\\
                    0.808122035641769 & -1.115904951264204 &  0.000000000000000\\
                    0.808122035641769 & -1.115904951264204 &  0.000000000000001\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                Q_{clgs} - Q_{qr} = \left[
                \begin{array}{ccc}
                    0.202030508910442 &  0.632346139049716 & -0.000000000000001\\
                    0.808122035641769 &  0.706739802467330 & -0.000000000000000\\
                    1.414213562373095 &  0.781133465884943 & -0.000000000000001\\
                    0.808122035641769 & -1.115904951264204 &  0.000000000000001\\
                    0.808122035641769 & -1.115904951264204 &  0.000000000000000\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                Q_{mgs} - Q_{house} = \left[
                \begin{array}{ccc}
                    0.202030508910442 &  0.632346139049716 &  0.000000000000000\\
                    0.808122035641769 &  0.706739802467329 & -0.000000000000000\\
                    1.414213562373095 &  0.781133465884943 &                  0\\
                    0.808122035641769 & -1.115904951264204 & -0.000000000000000\\
                    0.808122035641769 & -1.115904951264204 & -0.000000000000000\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                Q_{mgs} - Q_{qr} = \left[
                \begin{array}{ccc}
                    0.202030508910442 &  0.632346139049716 & -0.000000000000000\\
                    0.808122035641769 &  0.706739802467330 &  0.000000000000000\\
                    1.414213562373095 &  0.781133465884943 & -0.000000000000000\\
                    0.808122035641769 & -1.115904951264204 & -0.000000000000000\\
                    0.808122035641769 & -1.115904951264204 & -0.000000000000000\\
                \end{array}
                \right]
            \end{equation*}
            \begin{equation*}
                Q_{house} - Q_{qr} = (1.0e-15) * \left[
                \begin{array}{ccc}
                    0 & -0.388578058618805 & -0.555111512312578\\
                    -0.055511151231258 &  0.277555756156289 &  0.444089209850063\\
                     0.111022302462516 &  0.055511151231258 & -0.333066907387547\\
                    -0.055511151231258 & -0.222044604925031 &  0.277555756156289\\
                    -0.055511151231258 & -0.222044604925031 & -0.083266726846887\\
                \end{array}
                \right]
            \end{equation*}
    \newpage
    \section*{5}
        先由以下Matlab code生成A和b\\
        A(i,j)表示第i個points的j次方\\
        b(i)表示$f(x_i)$\\
        故要求出一個向量C使得$||AC-B||$最小\\
        \lstset{language=Matlab}
        \begin{lstlisting}
            function [A b]= Problem5(m,n)
                A = zeros(m,n);
                b = zeros(m,1);
                randomX = -1 + 2*rand(50,1);
                for i = 1:m
                    for j = 1:n
                        A(i,j) = randomX(i)^(j-1);
                    end
                    b(i) = 1/(1+25*randomX(i)*randomX(i));
                end
            end
        \end{lstlisting} 
        \subsection*{(a)}
            normal equation
            \[
                C = (A^TA)^{-1}A^Tb = (1.0e+02) * \left[
                \begin{array}{c}
                    0.009266423367277\\
                    0.000730039608735\\
                    -0.108840944793721\\
                    -0.028573061155644\\
                    0.552804577730198\\
                    0.209382086193257\\
                    -1.280292616257701\\
                    -0.562589305946127\\
                    1.344327841477173\\
                    0.630741675839826\\
                    -0.519962759549714\\
                    -0.250389421464620\\
                \end{array}
                \right]
            \]
        \subsection*{(b)}
                \[C = R^{-1}Q^Tb\]\\
            \subsubsection*{clgs}
            \[
                C = (1.0e+02) * \left[
                \begin{array}{c}
                    0.009266423367466\\
                    0.000730039607547\\
                    -0.108840944804360\\
                    -0.028573061126327\\
                    0.552804577828534\\
                    0.209382086004154\\
                    -1.280292616563978\\
                    -0.562589305456206\\
                    1.344327841863105\\
                    0.630741675288278\\
                    -0.519962759720052\\
                    -0.250389421238670\\
                \end{array}
                \right]
            \]
            \subsubsection*{mgs}
            \[
                C = (1.0e+02) * \left[
                \begin{array}{c}
                    0.009266423367476\\
                    0.000730039607261\\
                    -0.108840944804852\\
                    -0.028573061120461\\
                    0.552804577832482\\
                    0.209382085970047\\
                    -1.280292616575244\\
                    -0.562589305374260\\
                    1.344327841876387\\
                    0.630741675201564\\
                    -0.519962759725604\\
                    -0.250389421205177\\
                \end{array}
                \right]
            \]
            \subsubsection*{house}
            \[
                C = (1.0e+02) * \left[
                \begin{array}{c}
                    0.009266423367476\\
                    0.000730039607264\\
                    -0.108840944804823\\
                    -0.028573061120535\\
                    0.552804577832215\\
                    0.209382085970520\\
                    -1.280292616574408\\
                    -0.562589305375484\\
                    1.344327841875328\\
                    0.630741675202948\\
                    -0.519962759725135\\
                    -0.250389421205744\\
                \end{array}
                \right]
            \]
            \subsubsection*{qr}
            \[
                C = (1.0e+02) * \left[
                \begin{array}{c}
                    0.009266423367476\\
                    0.000730039607264\\
                    -0.108840944804823\\
                    -0.028573061120534\\
                    0.552804577832217\\
                    0.209382085970509\\
                    -1.280292616574416\\
                    -0.562589305375445\\
                    1.344327841875344\\
                    0.630741675202894\\
                    -0.519962759725144\\
                    -0.250389421205719\\
                \end{array}
                \right]
            \]
        \subsection*{(c)}
            \begin{itemize}
                \item 各種QR分解求出的C的差異
                    \subitem norm(Cclgs-Cmgs,2) = 1.300158998436881e-08
                    \subitem norm(Cclgs-Chouse,2) = 1.278435505825690e-08 
                    \subitem norm(Cclgs-Cqr,2) = 1.279171694197872e-08
                    \subitem norm(Cmgs-Chouse,2) = 2.465714855962380e-10
                    \subitem norm(Cmgs-Cqr,2) = 2.396182370231675e-10
                    \subitem norm(Cqr-Chouse,2) = 7.560032136098663e-12
                    \subitem 可以看出qr和house最接近
            \end{itemize}
                2-norm error $E = ||Q^TQ-I||_2$
            \subsubsection*{clgs}
                \[
                    norm((Qclgs'*Qclgs)-eye(size(Qclgs,2)),2) = 4.741139005678812e-11    
                \]
            \subsubsection*{mgs}
                \[
                    norm((Qmgs'*Qmgs)-eye(size(Qmgs,2)),2) = 2.300945671132748e-13    
                \]
            \subsubsection*{house}
                \[
                    norm((Qhouse'*Qhouse)-eye(size(Qhouse,2)),2) = 7.826796311242105e-16    
                \]
            \subsubsection*{qr}
                \[
                    norm((Qqr'*Qqr)-eye(size(Qqr,2)),2) = 6.962555005180799e-16    
                \]
        \subsection*{(d)}
            \subsubsection*{n==20}
                \begin{equation*}
                    \begin{aligned}
                        &norm((Qclgs'*Qclgs)-eye(size(Qclgs,2)),2) = 0.284247463207761\\    
                        &norm((Qmgs'*Qmgs)-eye(size(Qmgs,2)),2) = 8.746716932470064e-10\\
                        &norm((Qhouse'*Qhouse)-eye(size(Qhouse,2)),2) = 8.529010197342084e-16\\
                        &norm((Qqr'*Qqr)-eye(size(Qqr,2)),2) = 8.036632735576470e-16\\    
                    \end{aligned}
                \end{equation*}
            \subsubsection*{n==30}
                \begin{equation*}
                    \begin{aligned}
                        &norm((Qclgs'*Qclgs)-eye(size(Qclgs,2)),2) = 10.176122881374289\\    
                        &norm((Qmgs'*Qmgs)-eye(size(Qmgs,2)),2) = 1.510355723260155e-04\\
                        &norm((Qhouse'*Qhouse)-eye(size(Qhouse,2)),2) = 1.001577096959183e-15\\
                        &norm((Qqr'*Qqr)-eye(size(Qqr,2)),2) = 1.247852933110411e-15\\    
                    \end{aligned}
                \end{equation*}
            \subsubsection*{n==40}
                \begin{equation*}
                    \begin{aligned}
                        &norm((Qclgs'*Qclgs)-eye(size(Qclgs,2)),2) = 16.648385424780358\\    
                        &norm((Qmgs'*Qmgs)-eye(size(Qmgs,2)),2) = 0.996687978626385\\
                        &norm((Qhouse'*Qhouse)-eye(size(Qhouse,2)),2) = 1.464687304136877e-15\\
                        &norm((Qqr'*Qqr)-eye(size(Qqr,2)),2) = 1.353685187305758e-15\\    
                    \end{aligned}
                \end{equation*}
            \begin{itemize}
                \item 由觀察知道Error隨著n(多項式次數)增加而變大
                \item clgs的Error增加幅度最大，mgs次之，house以及qr的增加則比較不明顯
            \end{itemize}
\end{CJK}
\end{document}